const TabPersosRecherche = [
    { prenom: "Kurapika", nom: "", image: "../Ressources/Personnages/kurapika.jpg", hatsu: "Emperor Time" },
    // Examen Hunter
    { prenom: "Irumi", nom: "Zoldik", image: "../Ressources/Personnages/irumi.jpg", hatsu: "Needle People" },
    // Famille Zoldik
    { prenom: "Zeno", nom: "Zoldik", image: "../Ressources/Personnages/zeno.jpg", hatsu: "Dragon Lance" },
    { prenom: "Karuto", nom: "Zoldik", image: "../Ressources/Personnages/karuto.webp", hatsu: "Danse des méandres" },
    // York Shin City
    { prenom: "Feitan", nom: "Portor", image: "../Ressources/Personnages/feitan.jpg", hatsu: "Pain Packer" },
    { prenom: "Machi", nom: "Komachine", image: "../Ressources/Personnages/machi.jpg", hatsu: "Suture au fil de Nen" },
    { prenom: "Phinks", nom: "Magkav", image: "../Ressources/Personnages/phinks.jpg", hatsu: "Ripper Cyclotron" },
    { prenom: "Sharnalk", nom: "Ryusei", image: "../Ressources/Personnages/sharnalk.jpg", hatsu: "Black Voice" },
    { prenom: "Franklin", nom: "Bordeaux", image: "../Ressources/Personnages/franklin.jpg", hatsu: "Double Machine Gun" },
    { prenom: "Shizuku", nom: "Murasaki", image: "../Ressources/Personnages/shizuku.webp", hatsu: "Démé-Chan" },
    { prenom: "Pakunoda", nom: "", image: "../Ressources/Personnages/pakunoda.webp", hatsu: "Memory  Bullets" },
    { prenom: "Bonorenof", nom: "Ndongo", image: "../Ressources/Personnages/bono.webp", hatsu: "Battle Cantabile : Prologue "},
    { prenom: "Uvoguine", nom: "", image: "../Ressources/Personnages/uvoguine.jpeg", hatsu: "Big Bang Impact" },
    { prenom: "Korutopi", nom: "", image: "../Ressources/Personnages/korutopi.jpg", hatsu: "Gallery Fake" },
    // Greed Island
    { prenom: "Biscuit", nom: "Kruger", image: "../Ressources/Personnages/biscuit.png", hatsu: "Massage Piano" },
    { prenom: "Genthru", nom: "", image: "../Ressources/Personnages/genthru.jpg", hatsu: "Little Flower" },
    { prenom: "Rasor", nom: "", image: "../Ressources/Personnages/rasor.webp", hatsu: "14 Nen Devils" },
    // Kimera Ants
    { prenom: "Kaito", nom: "", image: "../Ressources/Personnages/kaito.jpg", hatsu: "Crazy Slot" },
    { prenom: "Meruem", nom: "", image: "../Ressources/Personnages/meruem.jpg", hatsu: "Nen Eater" },
    { prenom: "Neferupito", nom: "", image: "../Ressources/Personnages/neferupito.jpg", hatsu: "Doctor Blythe" },
    { prenom: "Shauapufu", nom: "", image: "../Ressources/Personnages/shauapufu.jpg", hatsu: "Beelzebub" },
    { prenom: "Meleoron", nom: "", image: "../Ressources/Personnages/meleoron.jpg", hatsu: "God's Accomplice" },
    { prenom: "Djido", nom: "", image: "../Ressources/Personnages/djido.png", hatsu: "Monroe Walk" },
    { prenom: "Zazan", nom: "", image: "../Ressources/Personnages/zazan.jpg", hatsu: "Queen Shot" },
    { prenom: "Leoru", nom:"", image: "../Ressources/Personnages/leoru.jpg", hatsu: "Rental Pod"},
    { prenom: "Werefin", nom:"", image: "../Ressources/Personnages/werefin.jpg", hatsu: "Missileman" },
    { prenom: "Ikarugo", nom:"", image: "../Ressources/Personnages/ikarugo.jpg", hatsu: "Living Dead Dolls"},
    { prenom: "Morau", nom: "McCarnathy", image: "../Ressources/Personnages/morau.jpg", hatsu: "Deep Purple" },
    { prenom: "Nov", nom: "", image: "../Ressources/Personnages/nov.jpg", hatsu: "Hide and Seek" },
    { prenom: "Knuckle", nom: "Bine", image: "../Ressources/Personnages/knuckle.jpg", hatsu: "Potclean" },
    { prenom: "Shoot", nom: "MacMahon", image: "../Ressources/Personnages/shoot.jpg", hatsu: "Hotel Rafflesia" },
    { prenom: "Pamu", nom: "Shiberia", image: "../Ressources/Personnages/pamu.jpg", hatsu: "Black Widow" },
];

const TabPersosHatsu = [
    { prenom: "Kurapika", nom: "", image: "../Ressources/Personnages/kurapika.jpg", hatsu: "Emperor Time" },
    // Examen Hunter
    { prenom: "Irumi", nom: "Zoldik", image: "../Ressources/Personnages/irumi.jpg", hatsu: "Needle People" },
    // Famille Zoldik
    { prenom: "Zeno", nom: "Zoldik", image: "../Ressources/Personnages/zeno.jpg", hatsu: "Dragon Lance" },
    { prenom: "Karuto", nom: "Zoldik", image: "../Ressources/Personnages/karuto.webp", hatsu: "Danse des méandres" },
    // York Shin City
    { prenom: "Feitan", nom: "Portor", image: "../Ressources/Personnages/feitan.jpg", hatsu: "Pain Packer" },
    { prenom: "Machi", nom: "Komachine", image: "../Ressources/Personnages/machi.jpg", hatsu: "Suture au fil de Nen" },
    { prenom: "Phinks", nom: "Magkav", image: "../Ressources/Personnages/phinks.jpg", hatsu: "Ripper Cyclotron" },
    { prenom: "Sharnalk", nom: "Ryusei", image: "../Ressources/Personnages/sharnalk.jpg", hatsu: "Black Voice" },
    { prenom: "Franklin", nom: "Bordeaux", image: "../Ressources/Personnages/franklin.jpg", hatsu: "Double Machine Gun" },
    { prenom: "Shizuku", nom: "Murasaki", image: "../Ressources/Personnages/shizuku.webp", hatsu: "Démé-Chan" },
    { prenom: "Pakunoda", nom: "", image: "../Ressources/Personnages/pakunoda.webp", hatsu: "Memory  Bullets" },
    { prenom: "Bonorenof", nom: "Ndongo", image: "../Ressources/Personnages/bono.webp", hatsu: "Battle Cantabile : Prologue "},
    { prenom: "Uvoguine", nom: "", image: "../Ressources/Personnages/uvoguine.jpeg", hatsu: "Big Bang Impact" },
    { prenom: "Korutopi", nom: "", image: "../Ressources/Personnages/korutopi.jpg", hatsu: "Gallery Fake" },
    // Greed Island
    { prenom: "Biscuit", nom: "Kruger", image: "../Ressources/Personnages/biscuit.png", hatsu: "Massage Piano" },
    { prenom: "Genthru", nom: "", image: "../Ressources/Personnages/genthru.jpg", hatsu: "Little Flower" },
    { prenom: "Rasor", nom: "", image: "../Ressources/Personnages/rasor.webp", hatsu: "14 Nen Devils" },
    // Kimera Ants
    { prenom: "Kaito", nom: "", image: "../Ressources/Personnages/kaito.jpg", hatsu: "Crazy Slot" },
    { prenom: "Meruem", nom: "", image: "../Ressources/Personnages/meruem.jpg", hatsu: "Nen Eater" },
    { prenom: "Neferupito", nom: "", image: "../Ressources/Personnages/neferupito.jpg", hatsu: "Doctor Blythe" },
    { prenom: "Shauapufu", nom: "", image: "../Ressources/Personnages/shauapufu.jpg", hatsu: "Beelzebub" },
    { prenom: "Meleoron", nom: "", image: "../Ressources/Personnages/meleoron.jpg", hatsu: "God's Accomplice" },
    { prenom: "Djido", nom: "", image: "../Ressources/Personnages/djido.png", hatsu: "Monroe Walk" },
    { prenom: "Zazan", nom: "", image: "../Ressources/Personnages/zazan.jpg", hatsu: "Queen Shot" },
    { prenom: "Leoru", nom:"", image: "../Ressources/Personnages/leoru.jpg", hatsu: "Rental Pod"},
    { prenom: "Werefin", nom:"", image: "../Ressources/Personnages/werefin.jpg", hatsu: "Missileman" },
    { prenom: "Ikarugo", nom:"", image: "../Ressources/Personnages/ikarugo.jpg", hatsu: "Living Dead Dolls"},
    { prenom: "Morau", nom: "McCarnathy", image: "../Ressources/Personnages/morau.jpg", hatsu: "Deep Purple" },
    { prenom: "Nov", nom: "", image: "../Ressources/Personnages/nov.jpg", hatsu: "Hide and Seek" },
    { prenom: "Knuckle", nom: "Bine", image: "../Ressources/Personnages/knuckle.jpg", hatsu: "Potclean" },
    { prenom: "Shoot", nom: "MacMahon", image: "../Ressources/Personnages/shoot.jpg", hatsu: "Hotel Rafflesia" },
    { prenom: "Pamu", nom: "Shiberia", image: "../Ressources/Personnages/pamu.jpg", hatsu: "Black Widow" },
];

const inputSearch = document.querySelector('.input-recherche');
const suggestionSearch = document.querySelector(".suggestion-recherche");
const comparaison = document.querySelector(".comparaison");
const persoADeviner = TabPersosHatsu[Math.floor(Math.random() * TabPersosHatsu.length)];
let persoPropose = null;

// Affichage du hatsu 
const t2Element = document.querySelector('.consigne-t2');
if (t2Element) {
    t2Element.textContent = `" ${persoADeviner.hatsu} "`;
}


function afficherSuggestion(PersonnagesFiltre) {
  suggestionSearch.innerHTML = ""; // Réinitialiser les suggestions
  
  PersonnagesFiltre.forEach((perso) => {
    // Création de l'élément
    const item = document.createElement("button");
    item.classList.add("suggestion-item");
    item.innerHTML = `<img class="suggestion-item-img" src="${perso.image}">
                      <span>${perso.prenom}</span>
                      <span>&nbsp;${perso.nom}</span>`;
  
    // Ajout dans le DOM
    suggestionSearch.appendChild(item);
  
    // Suppression dans suggestion-recherche + TabPersosRecherche
    item.addEventListener("click", () => {
      // Trouver le personnage correspondant
      persoPropose = TabPersosHatsu.find(p => p.prenom === perso.prenom);
      
      if (persoPropose) {
        // Supprimer le personnage de TabPersosRecherche
        const index = TabPersosRecherche.findIndex(p => p.prenom === perso.prenom);
        if (index !== -1) {
            TabPersosRecherche.splice(index, 1);
        }
        item.remove();
      }
    }) 
  })
}
  
inputSearch.addEventListener("keydown", (e) => {
    if (e.key === "Enter") {
        const premierItem = document.querySelector(".suggestion-item");
        if (premierItem) {
            premierItem.click();
        }
    }
})
  
inputSearch.addEventListener("input", () => {
    const requete = inputSearch.value.toLowerCase().trim();
  
    if (requete === "") {
        afficherSuggestion([]); // Cacher les suggestions si recherche vide
        return;
    }
  
    const filtre = TabPersosRecherche.filter((perso) => {
        const prenom = perso.prenom.toLowerCase();
        const nom = perso.nom.toLowerCase();
        return prenom.startsWith(requete) || nom.startsWith(requete);
    });
  
    suggestionSearch.style.display = filtre.length > 0 ? "block" : "none";
    afficherSuggestion(filtre);
});
  
function afficherComparaison(persoPropose, persoADeviner) {
    let couleur = persoPropose.prenom === persoADeviner.prenom ? "green" : "red";

    let tableauHTML = `
        <div class="comparaison-item" style="background-color: ${couleur}; box-shadow: 0 1px 15px ${couleur}, inset 0 0 10px rgba(255, 255, 255, 0.47)">
            <img class="comparaison-img" src="${persoPropose.image}"> 
            <span class="comparaison-text" >${persoPropose.prenom} ${persoPropose.nom}</span>
        </div>`;
  
  // Insérer le tableau dans le DOM
  comparaison.innerHTML = tableauHTML + comparaison.innerHTML;
}
  
function Victoire() {
    inputSearch.disabled = true; // Désactiver l'input pour bloquer le jeu
  
    // Créer un message de victoire
    const conteneur = document.querySelector('.conteneur3');
    const messageVictoire = document.querySelector('.victoire');
    conteneur.style.display = "block";
    // Ajouter le texte principal
    const textePrincipal = document.createElement('p');
    textePrincipal.textContent = "Il est trop chaud ! 🎉";
    textePrincipal.classList.add('victoire-t1');
  
    // Ajouter le message secondaire (t2)
    const messageRejouer = document.createElement('p');
    messageRejouer.textContent = "Pour rejouer, il suffit juste d'actualiser la page.";
    messageRejouer.classList.add('victoire-t2');
  
    // Ajouter les deux messages à la même div
    messageVictoire.appendChild(textePrincipal);
    messageVictoire.appendChild(messageRejouer);
    conteneur.appendChlid(messageVictoire);
  
}
  
// Gestionnaire d'événements sur le conteneur parent
suggestionSearch.addEventListener("click", (e) => {
    // Vérifie si l'élément cliqué est un élément .suggestion-item ou contenu dans un tel élément
    const item = e.target.closest(".suggestion-item");
    if (!item) return; // Si ce n'est pas un élément .suggestion-item, on ignore l'événement
    
    // Récupère le prénom et le nom depuis l'élément cliqué
    const prenom = item.querySelector("span:nth-child(2)").textContent.trim().toLowerCase();
    
    // Trouve le personnage correspondant
    persoPropose = TabPersosHatsu.find(perso => perso.prenom.toLowerCase() === prenom);
    if (persoPropose) {
        suggestionSearch.style.display = "none";
        afficherComparaison(persoPropose, persoADeviner);
        inputSearch.value = "";
        inputSearch.focus();
        if (persoPropose.prenom === persoADeviner.prenom) {
            document.querySelector('.comparaison-item').style.animation = "none";
            setTimeout(() => {
                Victoire(); // Appel de la fonction après 2 secondes
            }, 50); // Délai de 2000 ms (2 secondes)
        }
    }
})